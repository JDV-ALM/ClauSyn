<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vista del Wizard -->
    <record id="view_account_entries_wizard_form" model="ir.ui.view">
        <field name="name">account.entries.wizard.form</field>
        <field name="model">account.entries.wizard</field>
        <field name="arch" type="xml">
            <form string="Reporte de Apuntes Contables">
                <sheet>
                    <!-- Mostrar archivo generado si existe -->
                    <div invisible="not report_file" class="alert alert-success" role="alert">
                        <h4 class="alert-heading">隆Reporte Generado!</h4>
                        <p>El reporte ha sido generado exitosamente.</p>
                        <field name="report_filename" invisible="1"/>
                        <field name="report_file" filename="report_filename" invisible="1"/>
                        <button name="action_print_report" 
                                string=" Descargar Reporte" 
                                type="object" 
                                class="btn-primary"/>
                    </div>
                    
                    <group>
                        <group string="Filtros Principales">
                            <field name="company_id" groups="base.group_multi_company"/>
                            <field name="account_type" widget="radio"/>
                            <field name="partner_id" 
                                   domain="['|',
                                           ('customer_rank', '>', 0),
                                           ('supplier_rank', '>', 0)]"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="commission_seller_id"
                                   domain="[('is_commission_seller', '=', True)]"
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                        </group>
                        
                        <group string="Per铆odo y Estado">
                            <field name="date_from"/>
                            <field name="date_to"/>
                            <field name="state" widget="radio"/>
                            <field name="include_reconciled"/>
                        </group>
                    </group>
                    
                    <group>
                        <group string="Opciones del Reporte">
                            <field name="group_by_partner"/>
                            <field name="exclude_zero_invoices"/>
                            <field name="output_format" widget="radio"/>
                        </group>
                        <group>
                            <!-- Espacio para futuras opciones -->
                        </group>
                    </group>
                    
                    <notebook invisible="report_file">
                        <page string="Ayuda" name="help">
                            <div class="alert alert-info" role="alert">
                                <h4 class="alert-heading">癸 Informaci贸n del Reporte</h4>
                                <p><strong>Este wizard genera un reporte detallado de apuntes contables con las siguientes caracter铆sticas:</strong></p>
                                <ul>
                                    <li><strong>Tipo de Cuenta:</strong> Filtra por cuentas por cobrar (clientes) o por pagar (proveedores)</li>
                                    <li><strong>Cliente/Proveedor:</strong> Puede filtrar por un partner espec铆fico o incluir todos</li>
                                    <li><strong>Vendedor:</strong> Filtra por el usuario responsable de las facturas</li>
                                    <li><strong>Per铆odo:</strong> Define el rango de fechas para el reporte</li>
                                    <li><strong>Agrupaci贸n:</strong> Puede agrupar los apuntes por partner con subtotales</li>
                                </ul>
                                
                                <h5>Columnas del Reporte:</h5>
                                <ul>
                                    <li>Fecha del apunte contable</li>
                                    <li>N煤mero de asiento</li>
                                    <li>Partner y RIF/CI</li>
                                    <li>Referencia y descripci贸n</li>
                                    <li>Cuenta contable</li>
                                    <li>Montos: Debe, Haber, Balance</li>
                                    <li>Estado y conciliaci贸n</li>
                                    <li>Informaci贸n de factura (si aplica)</li>
                                </ul>
                            </div>
                        </page>
                    </notebook>
                </sheet>
                <footer>
                    <button name="action_generate_report" 
                            string=" Generar Reporte" 
                            type="object" 
                            class="btn-primary"
                            invisible="report_file"/>
                    <button name="action_generate_report" 
                            string=" Regenerar Reporte" 
                            type="object" 
                            class="btn-warning"
                            invisible="not report_file"/>
                    <button string="Cerrar" 
                            class="btn-secondary" 
                            special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
    
    <!-- Acci贸n del Wizard -->
    <record id="action_account_entries_wizard" model="ir.actions.act_window">
        <field name="name">Reporte de Apuntes Contables</field>
        <field name="res_model">account.entries.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="binding_model_id" ref="account.model_account_move_line"/>
        <field name="binding_view_types">list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Generar Reporte de Apuntes Contables
            </p>
            <p>
                Este wizard permite generar un reporte detallado de apuntes contables
                con filtros por tipo de cuenta, partner, vendedor y fechas.
            </p>
        </field>
    </record>
    
    <!-- Men煤 en Contabilidad -->
    <menuitem id="menu_account_entries_report"
              name="Reporte Apuntes por Tipo"
              parent="account.menu_finance_reports"
              action="action_account_entries_wizard"
              sequence="150"
              groups="account.group_account_user"/>
    
    <!-- Acci贸n alternativa desde el men煤 de Clientes -->
    <record id="action_account_entries_wizard_receivable" model="ir.actions.act_window">
        <field name="name">Reporte de Cuentas por Cobrar</field>
        <field name="res_model">account.entries.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{'default_account_type': 'receivable'}</field>
    </record>
    
    <menuitem id="menu_account_entries_receivable"
              name="Reporte por Cobrar"
              parent="account.menu_finance_receivables"
              action="action_account_entries_wizard_receivable"
              sequence="50"
              groups="account.group_account_user"/>
    
    <!-- Acci贸n alternativa desde el men煤 de Proveedores -->
    <record id="action_account_entries_wizard_payable" model="ir.actions.act_window">
        <field name="name">Reporte de Cuentas por Pagar</field>
        <field name="res_model">account.entries.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{'default_account_type': 'payable'}</field>
    </record>
    
    <menuitem id="menu_account_entries_payable"
              name="Reporte por Pagar"
              parent="account.menu_finance_payables"
              action="action_account_entries_wizard_payable"
              sequence="50"
              groups="account.group_account_user"/>
</odoo>